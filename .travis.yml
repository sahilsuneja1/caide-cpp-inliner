language: cpp
dist: xenial
sudo: false
git:
  submodules: false

addons:
  apt:
    packages: &default_packages
    - g++-7

matrix:
    include:
        # - env: CAIDE_USE_SYSTEM_CLANG=OFF

        - env: CAIDE_CLANG_VERSION=3.8 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                  - *default_sources
                  - sourceline: 'deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-3.8 main'
                    key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
                  packages:
                  - *default_packages
                  - libedit-dev
                  - libclang-3.8-dev
                  - llvm-3.8-dev

        - env: CAIDE_CLANG_VERSION=3.9 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                  - *default_sources
                  - sourceline: 'deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-3.9 main'
                    key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
                  packages:
                  - *default_packages
                  - libedit-dev
                  - libclang-3.9-dev
                  - llvm-3.9-dev

        - env: CAIDE_CLANG_VERSION=4.0 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                  - *default_sources
                  - sourceline: 'deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-4.0 main'
                    key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
                  packages:
                  - *default_packages
                  - libedit-dev
                  - libclang-4.0-dev
                  - llvm-4.0-dev

        - env: CAIDE_CLANG_VERSION=5.0 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                      - *default_sources
                      - llvm-toolchain-trusty-5.0
                  packages:
                      - *default_packages
                      - libedit-dev
                      - libclang-5.0-dev
                      - llvm-5.0-dev

        - env: CAIDE_CLANG_VERSION=6.0 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                      - *default_sources
                      - llvm-toolchain-trusty-6.0
                  packages:
                      - *default_packages
                      - libedit-dev
                      - libclang-6.0-dev
                      - llvm-6.0-dev

        - env: CAIDE_CLANG_VERSION=7.0 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                      - *default_sources
                      - llvm-toolchain-trusty-7
                  packages:
                      - *default_packages
                      - libedit-dev
                      - libclang-7-dev
                      - llvm-7-dev

        - env: CAIDE_CLANG_VERSION=8.0 CAIDE_USE_SYSTEM_CLANG=ON
          addons:
              apt:
                  sources:
                      - *default_sources
                      - llvm-toolchain-trusty-8
                  packages:
                      - *default_packages
                      - libedit-dev
                      - libclang-8-dev
                      - llvm-8-dev

    allow_failures:
        - env: CAIDE_CLANG_VERSION=3.7 CAIDE_USE_SYSTEM_CLANG=ON
        - env: CAIDE_CLANG_VERSION=3.9 CAIDE_USE_SYSTEM_CLANG=ON
        - env: CAIDE_CLANG_VERSION=7.0 CAIDE_USE_SYSTEM_CLANG=ON
        - env: CAIDE_CLANG_VERSION=8.0 CAIDE_USE_SYSTEM_CLANG=ON
    fast_finish: true


script:  travis/build-and-test.sh

notifications:
  email:
    on_failure: always

